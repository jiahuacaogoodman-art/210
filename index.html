<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>解剖学刷题神器 (云端同步版)</title>
    
    <!-- 1. 核心库：添加 crossorigin="anonymous" 以便捕获详细错误 -->
    <script crossorigin="anonymous" src="https://cdn.bootcdn.net/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script crossorigin="anonymous" src="https://cdn.bootcdn.net/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script crossorigin="anonymous" src="https://cdn.bootcdn.net/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- 2. Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        gray: { 850: '#1f2937', 900: '#111827', 950: '#030712' }
                    }
                }
            }
        }
    </script>

    <style>
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        .dark ::-webkit-scrollbar-thumb { background: #475569; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
        .login-bg { background-image: radial-gradient(#e5e7eb 1px, transparent 1px); background-size: 20px 20px; }
        .dark .login-bg { background-image: radial-gradient(#374151 1px, transparent 1px); }
        
        .spinner { border: 4px solid #f3f3f3; border-top: 4px solid #3498db; border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; margin: 20px auto; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body class="bg-gray-50 text-gray-900 dark:bg-gray-900 dark:text-gray-100 transition-colors duration-200">
    <div id="root">
        <div style="text-align:center; padding-top: 50px; font-family: sans-serif;">
            <div class="spinner"></div>
            <p>正在初始化应用...</p>
            <p style="font-size: 12px; color: #666; margin-top: 10px;">如果长时间停留在此页面，请检查网络连接。</p>
            <p style="font-size: 12px; color: #e74c3c; margin-top: 10px;" id="error-display"></p>
        </div>
    </div>

    <script>
        // 全局错误捕获
        window.onerror = function(message, source, lineno, colno, error) {
            console.error("Global Error:", message);
            const display = document.getElementById('error-display');
            if(display) display.innerHTML = `⚠️ 加载错误: ${message}<br/>建议刷新页面或检查网络。`;
        };
        if (window.location.protocol === 'file:') {
            document.getElementById('error-display').innerHTML += 
                "<br/>⚠️ 警告：检测到 file:// 协议，建议使用 VS Code Live Server 运行。";
        }
    </script>

    <script type="text/babel">
        try {
            const { useState, useEffect, useMemo } = React;

            // --- Firebase 初始化 ---
            const firebaseConfig = {
                apiKey: "AIzaSyDsXG028ldQRpisShIdUsDRnJ9wuVM4xTQ",
                authDomain: "cmu-anatomy.firebaseapp.com",
                projectId: "cmu-anatomy",
                storageBucket: "cmu-anatomy.firebasestorage.app",
                messagingSenderId: "481973249076",
                appId: "1:481973249076:web:813c63246b43efe03d1661",
                measurementId: "G-X4BX73GH3Y"
            };
            
            if (!firebase.apps.length) {
                firebase.initializeApp(firebaseConfig);
            }
            const auth = firebase.auth();

            // --- 图标组件 ---
            const Icon = ({ path, size = 20, className = "", ...props }) => (
                <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className} {...props}>{path}</svg>
            );
            const Icons = {
                Settings: (p) => <Icon {...p} path={<><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.09a2 2 0 0 1-1-1.74v-.47a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.35a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/><circle cx="12" cy="12" r="3"/></>} />,
                CheckCircle: (p) => <Icon {...p} path={<><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></>} />,
                XCircle: (p) => <Icon {...p} path={<><circle cx="12" cy="12" r="10"/><line x1="15" y1="9" x2="9" y2="15"/><line x1="9" y1="9" x2="15" y2="15"/></>} />,
                Save: (p) => <Icon {...p} path={<><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></>} />,
                Trash2: (p) => <Icon {...p} path={<><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/><line x1="10" y1="11" x2="10" y2="17"/><line x1="14" y1="11" x2="14" y2="17"/></>} />,
                Moon: (p) => <Icon {...p} path={<path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>} />,
                Sun: (p) => <Icon {...p} path={<><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></>} />,
                ChevronLeft: (p) => <Icon {...p} path={<polyline points="15 18 9 12 15 6"/>} />,
                ChevronRight: (p) => <Icon {...p} path={<polyline points="9 18 15 12 9 6"/>} />,
                List: (p) => <Icon {...p} path={<><line x1="8" y1="6" x2="21" y2="6"/><line x1="8" y1="12" x2="21" y2="12"/><line x1="8" y1="18" x2="21" y2="18"/><line x1="3" y1="6" x2="3.01" y2="6"/><line x1="3" y1="12" x2="3.01" y2="12"/><line x1="3" y1="18" x2="3.01" y2="18"/></>} />,
                RefreshCw: (p) => <Icon {...p} path={<><polyline points="23 4 23 10 17 10"/><polyline points="1 20 1 14 7 14"/><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/></>} />,
                Maximize: (p) => <Icon {...p} path={<><path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"/></>} />,
                Minimize: (p) => <Icon {...p} path={<><path d="M8 3v3a2 2 0 0 1-2 2H3m18 0h-3a2 2 0 0 1-2-2V3m0 18v-3a2 2 0 0 1 2-2h3M3 16h3a2 2 0 0 1 2 2v3"/></>} />,
                Zap: (p) => <Icon {...p} path={<polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/>} />,
                Shuffle: (p) => <Icon {...p} path={<><polyline points="16 3 21 3 21 8"/><line x1="4" y1="20" x2="21" y2="3"/><polyline points="21 16 21 21 16 21"/><line x1="15" y1="15" x2="21" y2="21"/><line x1="4" y1="4" x2="9" y2="9"/></>} />,
                Star: ({ filled, ...p }) => <Icon {...p} fill={filled ? "currentColor" : "none"} path={<polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2" />} />,
                Bookmark: (p) => <Icon {...p} path={<path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z" />} />,
                LogOut: (p) => <Icon {...p} path={<><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></>} />,
                User: (p) => <Icon {...p} path={<><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></>} />
            };

            const DEFAULT_ANSWERS_TEXT = `
1-10: C, D, B, B, B, E, B, C, C, C
11-20: B, A, D, C, C, D, D, D, C, B
21-30: E, D, D, B, A, E, D, E, C, E
31-40: B, E, C, D, E, C, C, B, E, C
41-50: E, D, C, B, E, E, D, A, E, D
51-60: E, B, D, E, C, D, E, C, D, D
61-70: C, B, E, A, E, C, A, E, D, C
71-80: A, E, C, C, C, A, C, B, D, A
81-90: B, A, C, B, B, B, B, E, E, A
91-100: E, C, C, D, D, D, A, E, D, A
101-110: C, E, C, D, D, E, A, E, A, D
111-120: E, C, C, B, E, B, A, C, C, C
121-130: B, B, C, B, C, D, A, B, B, B
131-140: B, E, C, B, C, B, C, A, D, D
141-150: E, D, C, D, E, E, E, D, E, C
151-160: D, C, D, B, D, D, D, E, A, B
161-170: B, D, A, C, E, D, B, D, C, A
171-180: D, C, C, E, B, A, C, E, E, C
181-190: D, E, D, B, C, C, D, C, A, C
191-200: B, C, A, E, B, C, A, A, B, B
201-210: D, E, C, B, D, B, D, E, C, B
`;

            const RAW_DATA = `
第一部分：第1-22题 (来源)
关于脊髓的正确描述是：
A. 在胸段大部分有侧角 B. 背侧有一条深陷的后正中裂 C. 是躯干和四肢的初级反射中枢 D. 成人从枕骨大孔至第2腰椎体下缘 E. 在新生儿时，下端平第1腰椎下缘
成人脊髓下端平齐：
A. 第1骶椎水平 B. 第2腰椎下缘水平 C. 第3腰椎与第4腰椎之间 D. 第1腰椎下缘水平 E. 第1腰椎下缘水平
第11-12胸椎受损伤，可累及脊髓的节段是：
A. 胸段 B. 腰段 C. 骶段 D. 腰、骶段 E. 骶、尾段
脊髓第5颈节段平对：
A. 第5颈椎下缘 B. 第4颈椎 C. 第3颈椎 D. 第6颈椎 E. 第7颈椎
脊神经前根的纤维成分是：
A. 躯体运动纤维和副交感神经纤维 B. 躯体运动纤维和内脏运动纤维 C. 躯体运动纤维和内脏感觉纤维 D. 内脏感觉纤维和交感神经纤维 E. 内脏感觉纤维和副交感神经纤维
脊髓的副交感神经低级中枢位于：
A. 全部骶节中 B. 骶1-3节中 C. 胸部和腰部脊髓侧角 D. 腰2-4节中 E.骶2-4节中
脊髓的交感神经低级中枢位于：
A. 胸核 B. 中间外侧核 C. 骶中间外侧柱 D. 中间内侧核 E. 网状结构
关于皮质脊髓侧束正确描述是：
A. 为本侧大脑皮质运动区的纤维 B. 位于脑桥被盖部 C. 位于脊髓的侧索内 D. 仅位于脊髓的颈、胸段 E. 延髓的锥体损伤时，为下位神经元瘫痪
关于楔束的正确描述是：
A. 贯穿脊髓后索全长 B. 主要传导下肢的深感觉和精细触觉 C. 楔束纤维上行到同侧楔束核内交换神经元 D. 传导对侧深感觉和精细触觉 E. 位于薄束的内侧
脊髓丘脑侧束：
A. 起始细胞在脊神经节内 B. 主要由不交叉的纤维组成 C. 终止于丘脑腹后外侧核 D. 传导本体感觉 E. 损伤后引起同侧本体感觉减退或消失
在脊髓断面内经白质前连合交叉到对侧的有：
A. 皮质脊髓侧束 B. 脊髓丘脑前束 C. 薄束 D. 楔束 E. 红核脊髓束
何处损伤可伤及脊髓骶段：
A. 第1腰椎 B. 第2腰椎 C. 第5腰椎 D. 第1、2骶椎 E. 第3腰椎
切断脊髓侧索，可导致切断部位以下：
A. 同侧随意运动丧失 B. 同侧随意运动及深感觉丧失 C. 同侧腱反射丧失，触觉和压觉丧失 D. 同侧随意运动丧失及对侧痛温觉障碍 E. 同侧痛温觉全部丧失
脊髓后索损伤时：
A. 闭眼能确定关节的位置 B. 闭眼能维持身体直立不摇晃 C. 闭眼不能确定各关节的位置 D. 闭眼能指鼻准确 E. 受损伤的对侧有痛觉障碍
脊髓第2胸节段右侧后索损伤后出现：
A. 左半身胸骨平面以下深感觉和精细触觉丧失 B. 右半身胸骨平面以下痛温觉和粗略触觉丧失 C. 右半身胸骨平面以下深感觉和精细触觉丧失 D. 左半身胸骨平面以下痛温觉和粗略触觉丧失 E. 左半身剑突平面下深感觉丧失
延髓前正中裂两旁的隆起是：
A. 橄榄体 B. 楔束结节 C. 薄束结节 D. 锥体 E. 小脑下脚
在延髓橄榄后沟出脑的神经是：
A. 第VI、VII、VIII对脑神经 B. 第VI对脑神经 C. 第XII对脑神经 D. 第IX、X、XI对脑神经 E. 第VII和VIII对脑神经
关于锥体交叉的正确描述是：
A. 位于延髓背侧下端 B. 交叉后纤维全部行于脊髓前索 C. 为皮质核束的纤维交叉 D. 交叉后纤维下行行于脊髓侧索 E. 锥体束纤维全部交叉
连接延髓与小脑的结构是：
A. 锥体 B. 橄榄体 C. 小脑下脚 D. 薄束结节 E. 楔束结节
从延髓脑桥沟出脑的神经，自内向外分别为：
A. 展神经、面神经 B. 展神经、面神经、前庭蜗神经 C. 展神经、面神经、前庭蜗神经、舌咽神经 D. 面神经、前庭蜗神经 E. 前庭蜗神经、面神经、展神经
从脑干背面出脑的神经是：
A. 视神经 B. 展神经 C. 动眼神经 D. 三叉神经 E. 滑车神经
三叉神经根位于：
A. 脑桥小脑三角处 B. 延髓脑桥沟处 C. 脚间窝处 D. 脑桥基底部与小脑中脚交界处 E. 以上都不是
第二部分：第23-53题 (来源)
从锥体与橄榄之间的沟出脑的神经是：
A. 舌咽神经 B. 迷走神经 C. 副神经 D. 舌下神经 E. 展神经
上泌涎核发出的纤维参与组成：
A. 舌咽神经 B. 面神经 C. 迷走神经 D. 动眼神经 E. 副神经
位于中脑的核团是：
A. 红核 B. 面神经核 C. 三叉神经脊束核 D. 孤束核 E. 展神经核
顶盖前区参与完成：
A. 痛觉反射 B. 听觉反射 C. 角膜反射 D. 触觉反射 E. 瞳孔对光反射
视觉反射中枢在：
A. 距状沟两侧 B. 外侧膝状体 C. 顶盖前区 D. 中脑上丘 E. 角回
不与延髓相连的脑神经有：
A. 副神经 B. 迷走神经 C. 舌下神经 D. 舌咽神经 E. 三叉神经
疑核发出的纤维支配：
A. 咀嚼肌 B. 面肌 C. 咽喉肌 D. 胸锁乳突肌 E. 斜方肌
疑核发出的纤维加入下列脑神经：
A. 第V、IV、X对 B. 第VII、IX、X对 C. 第V、VII、IX对 D. 第VII、IX、XI对 E. 第IX、X、XI对
上泌涎核纤维支配：
A. 腮腺 B. 泪腺、舌下腺、下颌下腺 C. 甲状腺 D. 胰腺 E. 胸腺
三叉神经脊束核接受来自下列哪组脑神经的传入纤维：
A. 第III、V、VII对 B. 第IV、VII、IX对 C. 第VII、IX、X对 D. 第V、X、XI对 E. 第V、IX、X对
位于延髓内的神经核是：
A. 三叉神经运动核 B. 上泌涎核 C. 薄束核 D. 面神经核 E. 展神经核
关于疑核的正确描述是：
A. 一般内脏感觉核 B. 特殊内脏感觉核 C. 躯体运动核 D. 特殊内脏运动核 E. 一般躯体运动核
下泌涎核发出的纤维加入：
A. 面神经 B. 三叉神经 C. 迷走神经 D. 舌下神经 E. 舌咽神经
面神经丘内含：
A. 面神经核 B. 前庭神经核 C. 展神经核 D. 滑车神经核 E. 蜗神经核
脑神经躯体运动核支配：
A. 平滑肌 B. 心肌 C. 肌节演发的骨骼肌 D. 腮弓演发的骨骼肌 E. 腺体
脑神经特殊内脏运动核发射纤维支配：
A. 舌肌、眼球外肌 B. 咀嚼肌、表情肌、咽喉肌 C. 颈肌 D. 心肌 E. 平滑肌
一般内脏运动核发出的纤维支配：
A. 舌肌、眼球外肌 B. 咽喉肌 C. 面肌 D. 咀嚼肌 E. 平滑肌、心肌、腺体
中脑内有：
A. 展神经核 B. 孤束核 C. 滑车神经核 D. 三叉神经脊束核 E. 面神经核
关于面神经核的正确描述是：
A. 接受对侧皮质脊髓束的纤维 B. 接受对侧皮质核束的纤维 C. 接受双侧皮质核束的纤维 D. 支配面上部的核，接受对侧皮质核束纤维 E. 支配眼裂以上的核，接受双侧皮质核束纤维
黑质：
A. 位于中脑被盖部 B. 仅见于人类 C. 经黑质纹状体纤维与旧纹状体相联系 D. 是脑内合成多巴胺的主要部位 E. 病变后可引起共济失调
脑桥内与小脑相关的核团是：
A. 三叉神经脑桥核 B. 上橄榄核 C. 脑桥核 D. 泌涎核 E. 蜗神经核
下丘是什么反射中枢：
A. 痛觉反射 B. 听觉反射 C. 角膜反射 D. 瞳孔对光反射 E. 触觉反射
动眼神经副核发出的纤维支配：
A. 舌下腺、下颌下腺 B. 腮腺 C. 泪腺 D. 胸腹腔脏器 E. 睫状肌、瞳孔括约肌
位于中脑的核团是：
A. 蓝斑 B. 泌涎核 C. 孤束核 D. 齿状核 E. 黑质
位于延髓的核团是：
A. 上橄榄核 B. 上泌涎核 C. 面神经核 D. 疑核 E. 展神经核
下泌涎核发出的纤维支配：
A. 腮腺 B. 泪腺、舌下腺、下颌下腺 C. 甲状腺 D. 胰腺 E. 胸腺
鳃弓衍化的骨骼肌包括：
A. 颈肌 B. 躯干肌 C. 四肢肌 D. 眼球外肌、舌肌 E. 咀嚼肌、表情肌、咽喉肌
关于丘系交叉的正确描述是：
A. 位于延髓的最下端 B. 交叉的纤维占80% C. 交叉纤维来自三叉神经脊束核 D. 交叉后的纤维上行终止于同侧丘脑 E. 传递本体感觉和精细触觉冲动
关于内侧丘系的正确描述是：
A. 纤维来自同侧的薄束核和楔束核 B. 终止于丘脑内侧核 C. 行经斜方体外侧，与斜方体有纤维联系 D. 最后经内囊，终止于中央后回 E. 传导精细触觉和意识性本体深感觉
关于内侧丘系的描述何者错误：
A. 传导四肢的本体感觉和精细触觉 B. 是浅感觉传导路的第二级神经元 C. 先位于锥体的背侧，后位于脑桥基底部与被盖之间 D. 在中脑位于红核的背外侧 E. 止于丘脑的腹后外侧核
锥体束：
A. 纤维起自大脑中央前回上2/3 B. 纤维均经过锥体交叉到对侧 C. 终于对侧脊髓前角运动神经元 D. 管理骨骼肌的随意运动 E. 以上都不对
第三部分：第54-83题 (来源)
关于三叉丘系的描述何者错误：
A. 起自三叉神经脊束核和三叉神经脑桥核 B. 在脑干对侧被盖部上行 C. 传导温、痛、触、压感觉 D. 止于丘脑腹后内侧核 E. 如受损，症状出现在受损的同侧
脊髓丘系终止于：
A. 腹前核 B. 背内侧核 C. 腹后外侧核 D. 内侧膝状体 E. 腹后内侧核
舌下神经核：
A. 管理舌的感觉与运动 B. 发出后经橄榄背侧出脑 C. 接受双侧皮质核束支配 D. 受损伤后伸舌时舌尖歪向患侧 E. 受损伤后舌肌不会萎缩
小脑：
A. 位于颅中窝 B. 上面与大脑枕叶直接相贴 C. 小脑扁桃体位于小脑蚓的后方 D. 绒球属新小脑 E. 借上脚与中脑联系
从小脑齿状核发出的纤维至：
A. 红核和丘脑前核 B. 红核和丘脑腹后外侧核 C. 红核和丘脑腹外侧核 D. 红核 E. 红核和丘脑背内侧核
前庭小脑包括：
A. 前叶 B. 后叶 C. 小脑体 D. 绒球小结叶 E. 整个蚓部
新小脑的传入纤维来自：
A. 齿状核 B. 前庭神经核 C. 红核 D. 脑桥核 E. 顶核
下列哪一束纤维不参加构成小脑下脚：
A. 脊髓小脑后束 B. 橄榄小脑束 C. 脑桥小脑束 D. 前庭小脑束 E. 小脑前庭束
丘脑腹后内侧核接受的纤维束是：
A. 外侧丘系 B. 三叉丘系 C. 内侧丘系 D. 脊髓丘脑束 E. 视辐射
外侧膝状体是：
A. 本体感觉的皮质下中枢 B. 痛、温觉的皮质下中枢 C. 内脏运动神经的皮质下中枢 D. 听觉的皮质下中枢 E. 视觉的皮质下中枢
穹隆连合：
A. 属于连合系 B. 属联络系 C. 连接两侧嗅球 D. 连接两侧海马旁回 E. 连接两侧丘脑
胼胝体：
A. 位于大脑外侧裂底 B. 呈放射状连接两半球皮质 C. 属联络系 D. 属投射系 E. 在脑正中矢状面上，可分为压部，干，膝，嘴
关于胼胝体的正确描述是：
A. 通过内囊 B. 组成侧脑室内侧壁 C. 位于大脑纵裂的底部 D. 联络脑干和丘脑 E. 有极重要的传导束
海马旁回位于：
A. 海马沟与侧副沟之间 B. 海马沟内侧 C. 侧副沟外侧 D. 侧脑室内 E. 以上都不是
中央旁小叶：
A. 位于中央前回 B. 位于中央后回 C. 位于枕叶 D. 位于顶叶 E. 位于中央前回和后回上端内侧面
组成边缘叶的结构是：
A. 海马，齿状回 B. 海马旁回，扣带回，杏仁复合体 C. 海马结构，下丘脑，丘脑前核 D. 海马结构，海马旁回和扣带回 E. 海马结构和杏仁复合体
关于基底核的正确描述是：
A. 又称新纹状体 B. 包括尾状核、豆状核和杏仁体 C. 是大脑髓质中的灰质块 D. 包括纹状体、屏状核 E. 参与组成边缘系统
第I躯体运动区位于：
A. 中央前回和中央旁小叶前部 B. 额中回后部 C. 额下回后部 D. 中央后回和中央旁小叶后部 E. 中央前回和中央后回
视觉区位于：
A. 额中回后部 B. 额下回后部 C. 扣带回后部 D. 海马回后部 E. 距状沟上、下的枕叶皮质
视觉性语言中枢位于：
A. 优势半球的中央前回 B. 优势半球的额中回后部 C. 优势半球的顶叶角回 D. 优势半球的顶缘上回 E. 优势半球的Broca回
关于大脑皮质功能定位区的描述哪项不正确：
A. 视区在枕叶的(Brodmann) 17区 B. 听区在颞横回 (Brodmann) 41、42区 C. 手的躯体运动区在中央前回下部 D. 脚的躯体运动区在中央旁小叶前部 E. 运动性语言中枢在额下回后部
内囊位于：
A. 豆状核与丘脑之间 B. 豆状核与尾状核之间 C. 豆状核与尾状核、背侧丘脑之间 D. 豆状核与屏状核之间 E. 豆状核、尾状核与屏状核之间
不通过内囊后肢的纤维束是：
A. 额桥束 B. 听辐射 C. 丘脑皮质束 D. 皮质脊髓束 E. 视辐射
左侧内囊膝部受损可出现：
A. 右侧肢体瘫痪 B. 左侧肢体瘫痪 C. 伸舌偏向右侧 D. 口角偏向右侧 E. 右侧额纹消失
关于内囊前肢的正确描述是：
A. 位于尾状核与丘脑之间 B. 位于豆状核与尾状核之间 C. 位于豆状核与背侧丘脑之间 D. 位于新旧纹状体之间 E. 有皮质脊髓束通过
通过内囊膝的下行纤维束是：
A. 皮质脊髓束 B. 丘脑皮质束 C. 听辐射 D. 皮质核束 E. 枕桥束
损伤左侧内囊后肢前份可能出现：
A. 右侧肢体痉挛性瘫痪 B. 右侧肢体弛缓性瘫痪 C. 左侧肢体痉挛性瘫痪 D. 左侧肢体痉挛性瘫痪 E. 左、右侧四肢痉挛性瘫痪
左侧内囊后肢受损可出现：
A. 同侧四肢麻痹和躯体感觉丧失 B. 双眼右侧视野同向性偏盲 C. 对侧痛、温觉丧失而触觉存在 D. 左耳听觉丧失 E. 双眼左侧视野同向性偏盲
属海马结构的：
A. 海马和齿状回 B. 海马旁回和海马 C. 海马旁回和钩 D. 海马旁回和齿状回 E. 海马旁回，钩和海马
下肢深部感觉传导路的交叉部位在：
A. 脊髓前连合 B. 脑桥臂 C. 延髓丘系交叉 D. 中脑结合臂 E. 间脑视交叉
第四部分：第84-113题 (来源)
本体感觉传导路的第三级神经元胞体位于：
A. 薄束核和楔束核 B. 背侧丘脑腹后外侧核 C. 背侧丘脑腹后内侧核 D. 丘脑前核 E. 丘脑底核
四肢的精细触觉的传导：
A. 起始细胞位于后角的背核 B. 由薄束、楔束来完成 C. 在脊髓交叉到对侧 D. 在中脑结合臂交叉 E. 起始细胞位于胶状质
头面部的痛温觉传导路的第一级神经元的胞体位于：
A. 脊神经节 B. 三叉神经节 C. 三叉神经脊束核 D. 三叉神经脑桥核 E. 三叉神经中脑核
内侧丘系：
A. 发自脊髓胸核 B. 发自薄束核和楔束核 C. 是非意识性传导纤维 D. 发自脊髓固有核 E. 传递温、痛觉
内侧丘系终止于丘脑的：
A. 腹后内侧核 B. 腹前核 C. 背内侧核 D. 腹外侧核 E. 腹后外侧核
躯干、四肢浅感觉传导路第二级神经元的胞体：
A. 脊神经节 B. 胸核 C. 丘脑腹外侧核 D. 下橄榄核 E. 以上都不是
意识性躯干、四肢深感觉传导路第二级神经元的胞体在：
A. 薄束核和楔束核 B. 后角固有核 C. 胸核 D. 丘脑腹后外侧核 E. 以上均不是
头面部浅感觉传导路第二级神经元的胞体在：
A. 脊神经节 B. 脊髓后角固有核 C. 胸核 D. 下橄榄核 E. 三叉神经脊束核和脑桥核内
头面部的触觉传导至：
A. 三叉神经脊束核 B. 三叉神经中脑核 C. 三叉神经脑桥核 D. 脊神经节 E. 三叉神经运动核
头面部浅感觉通路第三级神经元胞体在：
A. 腹前核 B. 底丘脑核 C. 背侧丘脑腹后内侧核 D. 背侧丘脑腹后外侧核 E. 背侧丘脑腹外侧核
皮质核束：
A. 支配对侧动眼神经核 B. 支配对侧动眼神经副核 C. 支配双侧面神经核 D. 支配对侧舌下神经核 E. 支配对侧疑核
左侧内囊损伤表现为：
A. 左额纹消失 B. 左侧能闭眼，左口角下垂 C. 左侧不能闭眼，右口角下垂 D. 右侧能闭眼，右口角下垂 E. 右侧不能闭眼，左口角下垂
只接受对侧皮质核束纤维的神经核是：
A. 三叉神经运动核 B. 滑车神经核 C. 动眼神经核 D. 舌下神经核 E. 展神经核
面神经上瘫：
A. 病灶的对侧能闭眼，口角偏向病灶同侧 B. 病灶的同侧不能闭眼，口角偏向病灶对侧 C. 病灶的同侧不能闭眼，口角偏向病灶同侧 D. 病灶的对侧不能闭眼，口角偏向病灶对侧
左侧视束完全损伤，表现为：
A. 左眼全盲 B. 左眼视野左侧偏盲 C. 右眼全盲 D. 双眼视野左侧偏盲 E. 双眼视野对侧同向性偏盲
下列何部位受损，可引起双眼视觉视野额偏盲：
A. 视交叉外侧部 B. 双侧视神经 C. 双侧视束 D. 视交叉中央部 E. 右视辐射
光照患者左眼，双眼瞳孔缩小，而照右眼时，双眼瞳孔均不缩小，病变为：
A. 右视神经 B. 左顶盖前区 C. 右外侧膝状体 D. 右动眼神经 E. 左外侧膝状体
损伤视交叉中央处，两眼视野表现为：
A. 双眼右侧偏盲 B. 左眼鼻侧偏盲 C. 双眼颞侧偏盲 D. 右眼鼻侧偏盲 E. 双眼全盲
损伤一侧大脑皮质躯体运动区可导致：
A. 对侧肢体瘫痪和机体能力减退 B. 对侧肢体瘫痪并有感觉障碍 C. 对侧肢体震颤并伴有肌张力增强 D. 同侧共济运动障碍和感觉障碍 E. 对侧肢体瘫痪和肌张力增强
下列关于皮质核束说法哪项是错误的：
A. 经内囊膝部下行 B. 舌下神经仅受对侧皮质核束支配 C. 一侧受损，对侧面部表情肌瘫痪 D. 止于脑干内的脑神经躯体运动核和特殊内脏运动核 E. 又称皮质延髓束或皮质脑干束
右侧内囊后脚后部损伤，可出现：
A. 右耳听力丧失 B. 左耳听力丧失 C. 左眼视野鼻侧和右眼视野颞侧偏盲 D. 右眼视野鼻侧和左眼视野颞侧偏盲 E. 双眼病灶侧视野同向性偏盲
患者右侧舌肌萎缩，伸舌时舌尖偏向右侧，其病变累及：
A. 左侧皮质核束 B. 右侧皮质核束 C. 左侧舌下神经核 D. 右侧舌下神经核 E. 右侧舌下神经
下列何项受损伤，可致对侧偏身运动障碍：
A. 红核脊髓束 B. 皮质核束 C. 皮质脊髓束 D. 内囊后脚 E. 内囊后脚和膝
脊髓的被膜由外向内依次为：
A. 硬脊膜、蛛网膜、软脊膜 B. 硬脊膜、软脊膜、蛛网膜 C. 软脊膜、蛛网膜、硬脊膜 D. 软脊膜、硬脊膜、蛛网膜 E. 蛛网膜、硬脊膜、软脊膜
正常成人的蛛网膜下隙向下延伸到：
A. 第1腰椎下缘 B. 第2腰椎下缘 C. 第3腰椎下缘 D. 第4腰椎下缘 E. 第2骶椎
属颈内动脉的分支是：
A. 后交通动脉 B. 脑膜中动脉 C. 前交通动脉 D. 大脑后动脉 E. 小脑上动脉
颈内动脉系与椎-基底动脉系的吻合支是：
A. 脑桥动脉 B. 前交通动脉 C. 脉络丛前动脉 D. 后交通动脉 E. 大脑中动脉
与脑的血液供应无关的动脉是：
A. 前、后交通动脉 B. 基底动脉 C. 椎动脉 D. 颈内动脉 E. 脑膜中动脉
运动性语言中枢的动脉供应来源于：
A. 大脑中动脉的中央支 B. 大脑前动脉的皮质支 C. 大脑中动脉的皮质支 D. 脑膜中动脉 E. 大脑后动脉的皮质支
属于颈内动脉的分支是：
A. 大脑后动脉 B. 小脑后上动脉 C. 大脑中动脉 D. 前交通动脉 E. 脑膜中动脉
第五部分：第114-146题 (来源)
基底动脉的分支不包括：
A. 大脑后动脉 B. 大脑中动脉 C. 小脑上动脉 D. 迷路动脉 E. 小脑下前动脉
供应枕叶的动脉来自：
A. 脉络丛前动脉 B. 大脑中动脉 C. 大脑前动脉 D. 后交通动脉 E. 大脑后动脉
供应大脑中央前回下2/3的动脉来自：
A. 大脑前动脉 B. 大脑中动脉 C. 大脑后动脉 D. 后交通动脉 E. 大脑中动脉中央支
脊髓前动脉来自：
A. 椎动脉 B. 大脑前动脉 C. 大脑后动脉 D. 颈内动脉 E. 迷路动脉
大脑动脉环 (Willis环) 的组成不包括：
A. 大脑后动脉 B. 颈内动脉 C. 椎动脉 D. 大脑前动脉 E. 前、后交通动脉
关于侧脑室的描述，哪项错误：
A. 中央部位于顶叶内 B. 下角在颞叶内伸向前内 C. 前角伸入枕叶内 D. 后角伸入枕叶 E. 侧脑室脉络丛位于前角和下角
关于第四脑室的正确描述是：
A. 位于延髓、脑桥和小脑之间 B. 经室间孔与侧脑室直接相通 C. 经正中孔和外侧孔与蛛网膜下隙交通 D. 顶部完全被小脑上脚覆盖 E. 底部由脑桥和中脑形成
关于脊神经的描述哪项是正确的：
A. 有30对 B. 除胸神经前支外，其余各脊神经前支分别交织成丛 C. 后支只含躯体感觉纤维 D. 不管理脊髓被膜 E. 各前支均借助灰、白交通支与交感干相连
只含感觉纤维成分的结构是：
A. 脊神经前根 B. 脊神经后根 C. 脊神经前支 D. 脊神经后支 E. 交通支
膈神经由哪些脊神经前支组成：
A. 颈4-8、胸1 B. 颈5-7、胸1 C. 颈5-8、胸1 D. 颈5-8、胸1-2 E. 颈4-7、胸1
在行程中贴近肱骨的神经是：
A. 正中神经、尺神经和桡神经 B. 腋神经、桡神经和尺神经 C. 腋神经、桡神经和正中神经 D. 桡神经、桡神经和皮神经 E. 正中神经、尺神经和皮神经
穿四边孔的神经是：
A. 旋肩胛神经 B. 桡神经 C. 腋神经 D. 肌皮神经 E. 胸背神经
肱骨外科颈骨折，最易损伤的神经是：
A. 桡神经 B. 正中神经 C. 尺神经 D. 腋神经 E. 肌皮神经
与肱深动脉伴行的神经是：
A. 桡神经 B. 肌皮神经 C. 正中神经 D. 腋神经 E. 尺神经
正中神经：
A. 来自臂丛外侧束和后束 B. 在臂部无分支 C. 支配臂间肌和鱼际肌 D. 经腕管浅面到达手掌 E. 在臂部损伤后前臂不能旋前，拇指不能内收
正中神经：
A. 支配全部鱼际肌 B. 经过屈肌支持带深面的腕管 C. 经过屈肌支持带的浅面 D. 支配第1、2骨间肌 E. 支配全部蚓状肌
第1、2蚓状肌是由哪一神经支配：
A. 尺神经深支 B. 正中神经 C. 桡神经深支 D. 骨间前神经 E. 桡神经浅支
胸长神经支配：
A. 背阔肌 B. 前锯肌 C. 小圆肌 D. 大圆肌 E. 冈上肌
支配喙肱肌的神经是：
A. 正中神经 B. 尺神经 C. 桡神经 D. 腋神经 E. 肌皮神经
桡神经：
A. 以内、外侧束出发自臂丛内、外侧束 B. 与旋肱后动脉伴行穿四边孔 C. 与肱深动脉伴行 D. 在肱二头肌沟内由外上斜向内下行 E. 支配臂肌前群和肌前群
桡神经浅支：
A. 沿桡侧腕屈肌深面下行 B. 前臂上1/3段与桡动脉伴行 C. 前臂中1/3段与桡动脉分开 D. 经肱桡肌深面转至前臂背侧区 E. 以上都不对
前臂外侧部皮肤感觉消失是哪条神经受损：
A. 桡神经 B. 正中神经 C. 肌皮神经 D. 尺神经 E. 腋神经
关于桡神经的描述哪项是正确的：
A. 是内侧束发出的一条粗大神经 B. 支配肱桡肌 C. 支配骨间背侧肌中指 D. 损伤后手指背侧皮肤感觉障碍 E. 深支穿旋前圆肌到前臂背侧
尺神经：
A. 在臂部发出分支支配肱二头肌 B. 在臂下部与肱动脉伴行 C. 行经肱骨内上髁与尺骨鹰嘴之间 D. 穿尺侧腕屈肌入肘窝 E. 以上都不对
尺神经在腕前区损伤：
A. 各指不能互相靠拢 B. 拇指不能外展 C. 手掌桡侧半皮肤感觉消失 D. 鱼际肌瘫痪 E. 以上都不对
拇指不能对掌是因为损伤：
A. 拇收肌 B. 蚓状肌 C. 尺神经深支 D. 正中神经返支 E. 以上都不对
支配拇收肌的神经是：
A. 正中神经返支 B. 桡神经浅支 C. 肌皮神经 D. 尺神经深支 E. 尺神经浅支
支配手肌外侧群的神经是：
A. 尺神经 B. 桡神经 C. 正中神经 D. 骨间后神经 E. 正中神经和尺神经
通过腕管的神经是：
A. 尺神经 B. 尺神经深支 C. 指掌侧总神经 D. 正中神经 E. 以上都不对
患者手掌内侧1/3皮肤感觉障碍，但拇指能对掌和内收，受损伤的神经是：
A. 正中神经 B. 尺神经深支 C. 尺神经浅支 D. 桡神经 E. 尺神经手背支
患者右手不能用伸直的示指和中指夹住一张卡片，受损伤的神经是：
A. 桡神经浅支 B. 正中神经返支 C. 尺神经浅支 D. 尺神经深支 E. 桡神经深支
支配骨间掌侧、背侧肌的神经是：
A. 腋神经 B. 正中神经 C. 肌皮神经 D. 桡神经 E. 尺神经
胸神经前支：
A. 12对胸神经前支各位于相应的肋间隙中 B. 肌支只支配胸肌 C. 皮支只分布于胸、腹壁的皮肤 D. 胸6神经分布于肋弓平面的腹壁皮肤 E. 第12对胸神经又称肋下神经
第六部分：第147-180题 (来源)
关于胸壁皮肤神经支配的节段性描述哪项是错误的：
A. 胸2相当于胸骨角平面 B. 胸4相当于乳头平面 C. 胸6相当于剑突平面 D. 胸10相当于脐平面 E. 胸12相当于耻骨联合上缘平面
关于股神经的正确描述是：
A. 发自骶丛 B. 在股三角内位于股动脉的内侧 C. 支配大腿前群肌和内侧群肌 D. 支配耻骨肌和大腿前群肌 E. 经腹股沟中点进入股部
进入收肌管的神经是：
A. 闭孔神经皮支 B. 股神经皮支 C. 生殖股神经 D. 胫神经 E. 隐神经
参与膝反射的神经是：
A. 胫神经和闭孔神经 B. 腓总神经和股神经 C. 股神经 D. 胫神经 E. 股神经和胫神经
闭孔神经不支配：
A. 股薄肌 B. 耻骨肌 C. 大收肌 D. 闭孔内肌 E. 闭孔外肌
对腓总神经的描述哪项不正确：
A. 自坐骨神经发出 B. 绕腓骨颈外侧向前行 C. 伴随胫前动脉到小腿前部 D. 发出腓肠外侧皮神经 E. 不支配股后部和臀部肌
腓浅神经不管理：
A. 腓骨长肌 B. 腓骨短肌 C. 第2-5趾背侧皮肤 D. 胫骨前肌 E. 小腿外侧皮肤
患者足下垂和足背皮肤感觉缺失，损伤可能涉及：
A. 脐神经和腓浅神经 B. 腓总神经 C. 腰骶干 D. 骶1-2的前支 E. 腓深神经
股神经：
A. 来自腰2-4的后支 B. 位于股动脉内侧 C. 支配股薄肌 D. 支配小腿内侧的皮肤感觉 E. 支配大腿外侧部的皮肤感觉
腘窝外侧角外伤易损伤：
A. 隐神经 B. 胫神经 C. 股后皮神经 D. 腓总神经 E. 坐骨神经
胫神经不支配：
A. 趾长屈肌 B. 拇长屈肌 C. 胫骨后肌 D. 胫骨前肌 E. 腓肠肌
通过海绵窦内侧壁的神经是：
A. 动眼神经 B. 滑车神经 C. 眼神神经 D. 视神经 E. 展神经
眼睑下垂是由于损伤了：
A. 动眼神经 B. 眼神神经 C. 面神经 D. 展神经 E. 滑车神经
动眼神经不支配：
A. 内直肌 B. 上斜肌 C. 下斜肌 D. 上睑提肌 E. 上直肌
眼外斜视是因为损伤了下列哪条神经：
A. 眼神神经 B. 动眼神经 C. 面神经 D. 展神经 E. 滑车神经
通过海绵窦外侧壁的脑神经：
A. III、IV、V、VI对脑神经 B. III、IV、V对脑神经 C. III、IV、VI对脑神经 D. III、IV对及眼神神经、上颌神经
左外展神经损伤出现：
A. 左瞳孔偏向内侧 B. 左瞳孔偏向外侧 C. 右瞳孔偏向内侧 D. 右瞳孔偏向外侧 E. 右瞳孔移向上方
传导头面部痛、温觉冲动的神经是：
A. 第III对脑神经 B. 第IV对脑神经 C. 第V对脑神经 D. 第VI对脑神经 E. 第VIII对脑神经
穿过卵圆孔的结构是：
A. 面神经的鼓索 B. 岩大神经 C. 上颌神经 D. 滑车神经 E. 下颌神经
上颌神经通过的孔是：
A. 破裂孔 B. 棘孔 C. 卵圆孔 D. 圆孔 E. 茎乳孔
支配颊肌运动的神经是：
A. 颊神经 B. 面神经 C. 下颌舌骨肌神经 D. 下颌神经 E. 舌咽神经
管理舌的感觉的脑神经有：
A. 舌下神经 B. 三叉神经和视神经 C. 滑车神经和舌下神经 D. 三叉神经、舌咽神经和面神经 E. 三叉神经、展神经和迷走神经
滑车神经支配：
A. 上直肌 B. 提上睑肌 C. 上斜肌 D. 下斜肌 E. 内直肌
不与脑干相连的脑神经：
A. 嗅神经 B. 三叉神经 C. 动眼神经 D. 滑车神经 E. 副神经
患者角膜反射消失，可能损伤了：
A. 视神经或三叉神经 B. 视神经或动眼神经 C. 动眼神经或面神经 D. 面神经或三叉神经 E. 动眼神经或三叉神经
管理眼球角膜的神经是：
A. 展神经 B. 视神经 C. 眼神神经 D. 滑车神经 E. 动眼神经
穿过眶上裂的结构为：
A. 眼神神经 B. 动眼脉 C. 滑车神经 D. 上颌神经 E. 下颌神经
面神经：
A. 起自中脑 B. 经卵圆孔离开颅腔 C. 支配咀嚼肌 D. 分布于面部皮肤 E. 支配下颌下腺的分泌
面神经管理：
A. 面部皮肤感觉 B. 舌前2/3味觉 C. 咀嚼肌运动 D. 茎突舌肌运动 E. 无以上情况
面神经管理：
A. 面部表情肌的运动 B. 茎突舌肌的运动 C. 舌后1/3的味觉 D. 咀嚼肌的运动 E. 舌前2/3的一般感觉
穿过茎乳孔的结构是：
A. 面动脉 B. 脑膜中动脉 C. 面神经 D. 舌下神经 E. 副神经
面神经在出颅处受损，下列哪项表现不会出现：
A. 患侧额纹消失 B. 患侧不能闭眼 C. 患侧鼻唇沟消失 D. 患侧眼角膜反射消失 E. 患侧眼泪溢障而引起角膜干燥
面神经不支配的肌肉是：
A. 眼轮匝肌 B. 颊肌 C. 颈阔肌 D. 口轮匝肌 E. 颞肌
舌的味觉纤维走行在：
A. 面神经和舌下神经 B. 面神经和迷走神经 C. 面神经和舌咽神经 D. 舌咽神经和迷走神经 E. 舌咽神经和舌下神经
第七部分：第181-210题 (来源)
伴随颈内动脉穿过海绵窦的神经是：
A. 视神经 B. 动眼神经 C. 滑车神经 D. 展神经 E. 眼神神经
前庭蜗神经进入颅腔的部位是：
A. 圆孔 B. 茎乳孔 C. 颈静脉孔 D. 外耳道 E. 内耳门
穿枕骨大孔入颅后又经颈静脉孔出颅的神经是：
A. 迷走神经脊髓根 B. 舌下神经 C. 副神经延髓根 D. 副神经脊髓根 E. 舌咽神经
迷走神经不支配：
A. 环甲肌 B. 乙状结肠 C. 咽中缩肌 D. 胃 E. 十二指肠
喉上神经支配：
A. 环杓后肌 B. 环杓侧肌 C. 环甲肌 D. 甲杓肌 E. 杓斜肌
在颈部损伤左喉返神经，将引起：
A. 喉前庭感觉消失 B. 吞咽时喉不能上提 C. 声门关闭不全 D. 左侧环甲肌瘫痪 E. 右侧环甲肌瘫痪
关于喉返神经的正确描述是：
A. 支配所有喉肌 B. 与甲状腺下动脉交叉 C. 与喉上神经喉内支性质相同 D. 右喉返神经绕右锁骨下动脉 E. 属于副交感神经
分布到声门裂以下喉粘膜的感觉神经是：
A. 舌咽神经舌支 B. 舌下神经 C. 喉返神经 D. 喉上神经 E. 舌下神经
通过颈静脉孔的神经有：
A. 舌咽神经、迷走神经、副神经 B. 舌咽神经、舌下神经、副神经 C. 迷走神经、副神经、舌下神经 D. 舌咽神经、迷走神经 E. 迷走神经、副神经
唾液腺的副交感纤维走行在：
A. 面神经和舌下神经 B. 舌下神经和迷走神经 C. 面神经和舌咽神经 D. 舌咽神经和下颌神经 E. 舌咽神经和迷走神经
一侧舌下神经损伤时表现为：
A. 不能伸舌 B. 伸舌时舌尖偏向患侧 C. 伸舌时舌尖偏向健侧 D. 伸舌时舌尖上卷 E. 伸舌时舌尖居中
管理舌内肌和舌外肌运动的神经是：
A. 舌神经 B. 舌咽神经 C. 舌下神经 D. 舌下神经和舌咽神经 E. 舌神经和舌下神经
舌下神经：
A. 支配颊舌肌 B. 支配二腹肌 C. 发自疑核 D. 从延髓前外侧沟出脑 E. 管理舌的运动和感觉
舌的神经支配：
A. 舌肌由舌神经支配 B. 舌前2/3感觉由面神经管理 C. 舌前2/3的味觉由上颌神经管理 D. 舌后1/3黏膜感觉由迷走神经管理 E. 舌后1/3的味觉由舌咽神经管理
交感神经的低级中枢位于：
A. 胸1-12脊髓节 B. 胸1或颈8-腰2或腰3脊髓节 C. 骶2-4脊髓节 D. 胸1-腰4脊髓节
副交感神经的低级中枢位于：
A. 间脑和骶2-4脊髓节 B. 脑干和胸1-腰2脊髓节 C. 脑干和骶2-4脊髓节 D. 胸1-腰2脊髓节 E. 脑干
交感神经：
A. 低级中枢位于脊髓胸1-腰3节段的中间外侧核 B. 节前纤维经灰交通支终止于椎旁节 C. 节后纤维仅分布于躯干、四肢的血管、汗腺和竖毛肌 D. 不支配肾上腺 E. 以上都不是
至瞳孔的交感神经节后纤维起自：
A. 颈上N节 B. 颈下N节 C. 胸1-4椎旁N节 D. 耳N节 E. 睫状N节
至躯干四肢血管的交感神经节后纤维的胞体位于：
A. 胸、腰部的椎旁神经节 B. 全部交感神经节 C. 全部椎旁神经节 D. 全部腰交感神经节 E. 胸、腰部的椎旁神经节和椎前神经节
内脏大神经：
A. 属副交感神经节前纤维 B. 属交感神经节前纤维 C. 属交感神经节后纤维 D. 支配胸、腹腔脏器 E. 以上都不是
分布于腹腔脏器的交感神经节后纤维发自：
A. 胸5-12交感干神经节 B. 腰交感干神经节 C. 腰、骶交感干神经节 D. 椎前神经节 E. 胸1-5交感干神经节
支配下颌下腺的交感神经节前纤维的换元部位是：
A. 耳神经节 B. 睫状神经节 C. 下颌下神经节 D. 翼腭神经节 E. 颈上神经节
瞳孔散大是由于损伤了：
A. 视神经 B. 迷走神经 C. 动眼神经 D. 三叉神经 E. 交感神经
内脏大神经穿过：
A. 第1-5胸交感干神经节 B. 第5或第6-9胸交感干神经节 C. 第9、10胸交感干神经节 D. 第10以下的胸交感干神经节 E. 以上所有腰交感干神经节
含副交感节前纤维的脑神经是：
A. 副神经 B. 舌下神经 C. 滑车神经 D. 舌咽神经 E. 三叉神经
不含有副交感纤维成分的脑神经是：
A. 动眼神经 B. 展神经 C. 面神经 D. 舌咽神经 E. 迷走神经
不属于副交感神经节的是：
A. 下颌下神经节 B. 耳神经节 C. 翼腭神经节 D. 膝神经节 E. 睫状神经节
属于副交感神经节的是：
A. 螺旋神经节 B. 膝神经节 C. 上神经节 D. 三叉神经节 E. 翼腭神经节
与泪腺分泌有关的神经节是：
A. 睫状神经节 B. 下颌下神经节 C. 翼腭神经节 D. 迷走神经下节 E. 星状神经节
支配泪腺的副交感纤维来源于：
A. 迷走神经 B. 面神经 C. 三叉神经 D. 舌咽神经 E. 动眼神经
`;

            const parseQuestions = (text) => {
                const lines = text.split('\n').map(l => l.trim()).filter(l => l.length > 0);
                const questions = [];
                let currentQuestion = null;
                let questionCounter = 1;
                const headerRegex = /^(第一部分|第二部分|第三部分|第四部分|第五部分|第六部分|第七部分|第\d+-\d+题)/;
                lines.forEach(line => {
                    if (headerRegex.test(line)) return;
                    const isOption = /^[A-E]\./.test(line);
                    if (!isOption) {
                        if (currentQuestion) questions.push(currentQuestion);
                        currentQuestion = { id: questionCounter++, text: line, options: [] };
                    } else {
                        if (currentQuestion) {
                            const parts = line.split(/(?=[A-E]\.)/g);
                            parts.forEach(p => {
                                const cleanOpt = p.trim();
                                if (cleanOpt) currentQuestion.options.push(cleanOpt);
                            });
                        }
                    }
                });
                if (currentQuestion) questions.push(currentQuestion);
                return questions;
            };

            const parseFormattedAnswers = (text) => {
                const lines = text.split('\n').map(l => l.trim()).filter(l => l.length > 0);
                const keyMap = {};
                lines.forEach(line => {
                    const match = line.match(/^(\d+)-(\d+)\s*[:：]\s*(.*)$/);
                    if (match) {
                        const start = parseInt(match[1], 10);
                        const answerStr = match[3];
                        const answers = answerStr.split(/[,，\s]+/).filter(a => a.length > 0);
                        answers.forEach((ans, index) => {
                            keyMap[start + index] = ans.toUpperCase();
                        });
                    }
                });
                return keyMap;
            };

            const shuffleArray = (array) => {
                const arr = [...array];
                for (let i = arr.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [arr[i], arr[j]] = [arr[j], arr[i]];
                }
                return arr;
            };

            // --- 模态框组件 ---
            function Modal({ isOpen, title, message, onConfirm, onCancel, type = 'confirm' }) {
                if (!isOpen) return null;
                return (
                    <div className="fixed inset-0 bg-black/50 z-[100] flex items-center justify-center p-4">
                        <div className="bg-white dark:bg-gray-800 rounded-xl shadow-xl max-w-sm w-full p-6 transform transition-all scale-100 opacity-100">
                            <h3 className="text-lg font-bold mb-2 dark:text-white">{title || '提示'}</h3>
                            <p className="text-gray-600 dark:text-gray-300 mb-6">{message}</p>
                            <div className="flex justify-end gap-3">
                                {type === 'confirm' && (
                                    <button 
                                        onClick={onCancel}
                                        className="px-4 py-2 rounded text-gray-600 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-700 transition-colors"
                                    >
                                        取消
                                    </button>
                                )}
                                <button 
                                    onClick={onConfirm}
                                    className={`px-4 py-2 rounded text-white transition-colors ${type === 'danger' ? 'bg-red-600 hover:bg-red-700' : 'bg-blue-600 hover:bg-blue-700'}`}
                                >
                                    确定
                                </button>
                            </div>
                        </div>
                    </div>
                );
            }

            // --- 登录组件 ---
            function LoginScreen({ onLoginSuccess }) {
                const [email, setEmail] = useState("");
                const [password, setPassword] = useState("");
                const [isRegistering, setIsRegistering] = useState(false);
                const [error, setError] = useState("");
                const [loading, setLoading] = useState(false);

                const handleSubmit = async (e) => {
                    e.preventDefault();
                    setError("");
                    setLoading(true);
                    try {
                        if (isRegistering) {
                            await auth.createUserWithEmailAndPassword(email, password);
                        } else {
                            await auth.signInWithEmailAndPassword(email, password);
                        }
                    } catch (err) {
                        let msg = err.message;
                        if (err.code === 'auth/wrong-password') msg = "密码错误";
                        if (err.code === 'auth/user-not-found') msg = "用户不存在";
                        if (err.code === 'auth/email-already-in-use') msg = "该邮箱已被注册";
                        if (err.code === 'auth/weak-password') msg = "密码太弱 (至少6位)";
                        if (err.code === 'auth/invalid-email') msg = "邮箱格式不正确";
                        if (err.code === 'auth/network-request-failed') msg = "网络错误，无法连接到 Firebase (请检查VPN)";
                        setError(msg);
                    } finally {
                        setLoading(false);
                    }
                };

                return (
                    <div className="min-h-screen flex items-center justify-center login-bg p-4 bg-gray-50 dark:bg-gray-900 transition-colors">
                        <div className="bg-white dark:bg-gray-800 p-8 rounded-xl shadow-2xl w-full max-w-md border border-gray-100 dark:border-gray-700">
                            <div className="text-center mb-8">
                                <h1 className="text-3xl font-bold text-blue-600 dark:text-blue-400 mb-2">Anatomy 刷题神器</h1>
                                <p className="text-gray-500 dark:text-gray-400">请先登录以同步您的学习进度</p>
                            </div>

                            {error && (
                                <div className="bg-red-50 text-red-600 p-3 rounded mb-4 text-sm border border-red-100 dark:bg-red-900/30 dark:text-red-300 dark:border-red-800">
                                    {error}
                                </div>
                            )}

                            <form onSubmit={handleSubmit} className="space-y-4">
                                <div>
                                    <label className="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">邮箱</label>
                                    <input 
                                        type="email" 
                                        required 
                                        className="w-full p-2 rounded border dark:bg-gray-700 dark:border-gray-600 dark:text-white"
                                        value={email}
                                        onChange={(e) => setEmail(e.target.value)}
                                        placeholder="your@email.com"
                                    />
                                </div>
                                <div>
                                    <label className="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">密码</label>
                                    <input 
                                        type="password" 
                                        required 
                                        className="w-full p-2 rounded border dark:bg-gray-700 dark:border-gray-600 dark:text-white"
                                        value={password}
                                        onChange={(e) => setPassword(e.target.value)}
                                        placeholder="••••••••"
                                    />
                                </div>
                                <button 
                                    type="submit" 
                                    disabled={loading}
                                    className="w-full py-2 bg-blue-600 hover:bg-blue-700 text-white rounded font-medium transition-colors disabled:opacity-50 flex justify-center items-center"
                                >
                                    {loading ? "处理中..." : (isRegistering ? "注册账户" : "登录")}
                                </button>
                            </form>

                            <div className="mt-6 text-center text-sm">
                                <button 
                                    onClick={() => setIsRegistering(!isRegistering)}
                                    className="text-blue-600 dark:text-blue-400 hover:underline"
                                >
                                    {isRegistering ? "已有账号？去登录" : "没有账号？去注册"}
                                </button>
                            </div>
                        </div>
                    </div>
                );
            }

            // --- 主应用 ---
            function App() {
                // Auth State
                const [currentUser, setCurrentUser] = useState(null);
                const [authLoading, setAuthLoading] = useState(true);

                // Quiz State
                const [allQuestions, setAllQuestions] = useState([]);
                const [displayedQuestions, setDisplayedQuestions] = useState([]);
                const [currentQIndex, setCurrentQIndex] = useState(0);
                const [userAnswers, setUserAnswers] = useState({});
                const [answerKey, setAnswerKey] = useState({});
                const [bookmarks, setBookmarks] = useState([]);
                
                // UI States
                const [isSettingsOpen, setIsSettingsOpen] = useState(false);
                const [isOverviewOpen, setIsOverviewOpen] = useState(false);
                const [rawAnswerKeyInput, setRawAnswerKeyInput] = useState("");
                const [darkMode, setDarkMode] = useState(false);
                const [isFullscreen, setIsFullscreen] = useState(false);
                const [autoAdvance, setAutoAdvance] = useState(false);
                const [isRandomMode, setIsRandomMode] = useState(false);
                const [isFavoritesMode, setIsFavoritesMode] = useState(false);
                const [isDataLoaded, setIsDataLoaded] = useState(false);

                // Modal State
                const [modalConfig, setModalConfig] = useState({
                    isOpen: false,
                    title: '',
                    message: '',
                    onConfirm: () => {},
                    onCancel: () => {},
                    type: 'confirm'
                });

                // Helper to show modal
                const showModal = ({ title, message, onConfirm, type = 'confirm' }) => {
                    setModalConfig({
                        isOpen: true,
                        title,
                        message,
                        onConfirm: () => {
                            onConfirm();
                            setModalConfig(prev => ({ ...prev, isOpen: false }));
                        },
                        onCancel: () => setModalConfig(prev => ({ ...prev, isOpen: false })),
                        type
                    });
                };

                // Auth Listener
                useEffect(() => {
                    const unsubscribe = auth.onAuthStateChanged((user) => {
                        setCurrentUser(user);
                        setAuthLoading(false);
                    });
                    return unsubscribe;
                }, []);

                // Initial Data Load
                useEffect(() => {
                    const parsed = parseQuestions(RAW_DATA);
                    setAllQuestions(parsed);
                    
                    const savedAnswers = localStorage.getItem('anatomy_quiz_answers');
                    const savedMode = localStorage.getItem('anatomy_quiz_dark');
                    const savedAutoAdvance = localStorage.getItem('anatomy_quiz_autoadvance');
                    const savedRandomMode = localStorage.getItem('anatomy_quiz_random');
                    const savedBookmarks = localStorage.getItem('anatomy_quiz_bookmarks');
                    
                    if (savedAnswers) setUserAnswers(JSON.parse(savedAnswers));
                    if (savedMode) setDarkMode(JSON.parse(savedMode));
                    if (savedAutoAdvance) setAutoAdvance(JSON.parse(savedAutoAdvance));
                    if (savedBookmarks) setBookmarks(JSON.parse(savedBookmarks));
                    
                    let initialRandom = false;
                    if (savedRandomMode) {
                        initialRandom = JSON.parse(savedRandomMode);
                        setIsRandomMode(initialRandom);
                    }

                    if (initialRandom) {
                        setDisplayedQuestions(shuffleArray(parsed));
                    } else {
                        setDisplayedQuestions(parsed);
                    }

                    const defaultKey = parseFormattedAnswers(DEFAULT_ANSWERS_TEXT);
                    setAnswerKey(defaultKey);
                    setRawAnswerKeyInput(DEFAULT_ANSWERS_TEXT);
                    
                    setIsDataLoaded(true);
                }, []);

                // Save Data
                useEffect(() => {
                    if (isDataLoaded) {
                        localStorage.setItem('anatomy_quiz_answers', JSON.stringify(userAnswers));
                        localStorage.setItem('anatomy_quiz_dark', JSON.stringify(darkMode));
                        localStorage.setItem('anatomy_quiz_autoadvance', JSON.stringify(autoAdvance));
                        localStorage.setItem('anatomy_quiz_random', JSON.stringify(isRandomMode));
                        localStorage.setItem('anatomy_quiz_bookmarks', JSON.stringify(bookmarks));
                    }
                    
                    if (darkMode) {
                        document.body.classList.add('dark');
                    } else {
                        document.body.classList.remove('dark');
                    }
                }, [userAnswers, darkMode, autoAdvance, isRandomMode, bookmarks, isDataLoaded]);

                // Handle Logout
                const handleLogout = () => {
                    showModal({
                        title: '退出登录',
                        message: '确定要退出当前账号吗？',
                        type: 'danger',
                        onConfirm: async () => {
                            await auth.signOut();
                        }
                    });
                }

                const toggleRandomMode = () => {
                    const newMode = !isRandomMode;
                    setIsRandomMode(newMode);
                    setCurrentQIndex(0);

                    let baseList = [...allQuestions];
                    if (newMode) baseList = shuffleArray(baseList);
                    if (isFavoritesMode) {
                        setDisplayedQuestions(baseList.filter(q => bookmarks.includes(q.id)));
                    } else {
                        setDisplayedQuestions(baseList);
                    }
                };

                const toggleFavoritesMode = () => {
                    const newMode = !isFavoritesMode;
                    setIsFavoritesMode(newMode);
                    setCurrentQIndex(0);

                    if (newMode) {
                        let list = [...allQuestions];
                        if (isRandomMode) list = shuffleArray(list);
                        setDisplayedQuestions(list.filter(q => bookmarks.includes(q.id)));
                    } else {
                        let list = [...allQuestions];
                        if (isRandomMode) list = shuffleArray(list);
                        setDisplayedQuestions(list);
                    }
                };

                const toggleBookmark = (qId) => {
                    setBookmarks(prev => {
                        if (prev.includes(qId)) {
                            return prev.filter(id => id !== qId);
                        } else {
                            return [...prev, qId];
                        }
                    });
                };

                const parseAndSetKey = (input) => {
                    let keyMap = parseFormattedAnswers(input);
                    setAnswerKey(keyMap);
                };

                const toggleFullscreen = () => {
                    setIsFullscreen(!isFullscreen);
                };

                const handleOptionClick = (optionLabel) => {
                    const letter = optionLabel.charAt(0).toUpperCase();
                    const qId = displayedQuestions[currentQIndex].id;
                    
                    setUserAnswers(prev => ({
                        ...prev,
                        [qId]: letter
                    }));
                    if (autoAdvance && Object.keys(answerKey).length > 0 && letter === answerKey[qId]) {
                        if (currentQIndex < displayedQuestions.length - 1) {
                            setTimeout(() => {
                                setCurrentQIndex(prev => prev + 1);
                            }, 500);
                        }
                    }
                };

                const resetProgress = () => {
                    showModal({
                        title: '重置进度',
                        message: '确定要重置当前答题进度吗？(收藏夹不会被清空)',
                        type: 'danger',
                        onConfirm: () => {
                            setUserAnswers({});
                            setCurrentQIndex(0);
                        }
                    });
                };

                const hardReset = () => {
                    showModal({
                        title: '清空所有数据',
                        message: '警告：这将清空所有记录、收藏和设置，恢复到初始状态。确定吗？',
                        type: 'danger',
                        onConfirm: () => {
                            localStorage.clear();
                            window.location.reload();
                        }
                    });
                };

                const resetToDefaultKey = () => {
                    setRawAnswerKeyInput(DEFAULT_ANSWERS_TEXT);
                    setAnswerKey(parseFormattedAnswers(DEFAULT_ANSWERS_TEXT));
                }

                const getScore = () => {
                    let correct = 0;
                    let total = 0;
                    Object.keys(answerKey).forEach(qid => {
                        if (userAnswers[qid] === answerKey[qid]) correct++;
                        total++;
                    });
                    return { correct, total: Object.keys(answerKey).length || 0 };
                };
                
                const getStats = () => {
                    let correct = 0;
                    let answered = 0;
                    Object.keys(userAnswers).forEach(qid => {
                        if (answerKey[qid]) {
                            answered++;
                            if (userAnswers[qid] === answerKey[qid]) {
                                correct++;
                            }
                        }
                    });
                    const accuracy = answered > 0 ? Math.round((correct / answered) * 100) : 0;
                    return { correct, answered, accuracy };
                };

                const getOptionClass = (opt) => {
                    const letter = opt.charAt(0);
                    const qId = displayedQuestions[currentQIndex] ? displayedQuestions[currentQIndex].id : null;
                    const currentUserAnswer = qId ? userAnswers[qId] : null;
                    const currentCorrectAnswer = qId ? answerKey[qId] : null;

                    const isSelected = currentUserAnswer === letter;
                    const isCorrect = currentCorrectAnswer === letter;
                    let base = "p-4 rounded-lg border-2 cursor-pointer transition-all mb-3 flex items-center ";
                    const hasAnswerKey = Object.keys(answerKey).length > 0;

                    if (!hasAnswerKey) {
                        return base + (isSelected 
                            ? "bg-blue-100 border-blue-500 dark:bg-blue-900 dark:border-blue-400" 
                            : "border-gray-200 hover:bg-gray-50 dark:border-gray-700 dark:hover:bg-gray-800");
                    }

                    if (isSelected) {
                        if (isCorrect) return base + "bg-green-100 border-green-500 dark:bg-green-900 dark:border-green-400";
                        return base + "bg-red-100 border-red-500 dark:bg-red-900 dark:border-red-400";
                    }
                    
                    if (isCorrect && currentUserAnswer) {
                        return base + "bg-green-50 border-green-300 dark:bg-green-900/50 dark:border-green-600";
                    }

                    return base + "border-gray-200 hover:bg-gray-50 dark:border-gray-700 dark:hover:bg-gray-800";
                };

                // Loading state
                if (authLoading) return (
                    <div className="min-h-screen flex flex-col items-center justify-center dark:bg-gray-900 dark:text-white">
                        <div className="spinner"></div>
                        <p>正在连接到云端...</p>
                    </div>
                );

                // --- 如果没有登录，显示登录界面 ---
                if (!currentUser) {
                    return <LoginScreen />;
                }

                // --- 以下是原有的 Quiz 界面 ---

                if (allQuestions.length === 0) return <div className="p-10 text-center dark:text-white">正在加载题目数据...</div>;

                const currentQ = displayedQuestions[currentQIndex];
                const hasAnswerKey = Object.keys(answerKey).length > 0;
                const currentCorrectAnswer = currentQ ? answerKey[currentQ.id] : null;
                const currentUserAnswer = currentQ ? userAnswers[currentQ.id] : null;
                const stats = getStats();
                const isBookmarked = currentQ ? bookmarks.includes(currentQ.id) : false;

                // Empty favorites state
                if (!currentQ && isFavoritesMode) {
                    return (
                        <div className={`${isFullscreen ? 'fixed inset-0 z-50 h-screen w-screen overflow-auto' : 'min-h-screen'} bg-gray-50 text-gray-900 dark:bg-gray-900 dark:text-gray-100 font-sans flex flex-col`}>
                            <header className="bg-white border-gray-200 dark:bg-gray-800 dark:border-gray-700 border-b p-4 sticky top-0 z-10 shadow-sm flex justify-between items-center">
                                <h1 className="font-bold text-xl">错题/收藏本</h1>
                                <button onClick={toggleFavoritesMode} className="px-4 py-2 bg-blue-600 text-white rounded">返回全部题目</button>
                            </header>
                            <div className="flex-1 flex flex-col items-center justify-center p-10 text-center">
                                <Icons.Bookmark size={48} className="text-gray-300 mb-4" />
                                <h2 className="text-xl font-bold mb-2">暂无收藏题目</h2>
                                <p className="text-gray-500">在做题时点击题目旁边的星星图标，即可加入这里。</p>
                            </div>
                        </div>
                    );
                }

                if (!currentQ) return <div className="p-10 text-center dark:text-white">Loading Question...</div>;

                return (
                    <div className={`${isFullscreen ? 'fixed inset-0 z-50 h-screen w-screen overflow-auto' : 'min-h-screen'} bg-gray-50 text-gray-900 dark:bg-gray-900 dark:text-gray-100 font-sans flex flex-col`}>
                        {/* 模态框 */}
                        <Modal 
                            isOpen={modalConfig.isOpen} 
                            title={modalConfig.title}
                            message={modalConfig.message}
                            onConfirm={modalConfig.onConfirm}
                            onCancel={modalConfig.onCancel}
                            type={modalConfig.type}
                        />

                        <header className="bg-white border-gray-200 dark:bg-gray-800 dark:border-gray-700 border-b p-4 sticky top-0 z-10 shadow-sm">
                            <div className="max-w-4xl mx-auto flex flex-col sm:flex-row justify-between items-center gap-4 sm:gap-0">
                                <h1 className="text-xl font-bold flex items-center gap-2">
                                    <span className="text-blue-600 dark:text-blue-400">Anatomy</span> 刷题神器
                                    {isRandomMode && (
                                        <span className="hidden md:flex text-xs font-normal bg-purple-100 text-purple-800 px-2 py-0.5 rounded-full dark:bg-purple-900 dark:text-purple-200 border border-purple-200 dark:border-purple-700 items-center gap-1">
                                            <Icons.Shuffle size={10}/> 随机
                                        </span>
                                    )}
                                    {isFavoritesMode && (
                                        <span className="hidden md:flex text-xs font-normal bg-yellow-100 text-yellow-800 px-2 py-0.5 rounded-full dark:bg-yellow-900 dark:text-yellow-200 border border-yellow-200 dark:border-yellow-700 items-center gap-1">
                                            <Icons.Star size={10} filled={true}/> 收藏本
                                        </span>
                                    )}
                                </h1>
                                <div className="flex gap-2 items-center">
                                    {/* 用户信息 & 退出 */}
                                    <div className="hidden md:flex items-center text-xs text-gray-500 mr-2 gap-1 border-r pr-3 dark:border-gray-700">
                                        <Icons.User size={14}/> {currentUser.email}
                                    </div>

                                    <button onClick={() => setDarkMode(!darkMode)} className="p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700">
                                        {darkMode ? <Icons.Sun size={20}/> : <Icons.Moon size={20}/>}
                                    </button>
                                    <button onClick={toggleFullscreen} className="p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700" title="全屏模式">
                                        {isFullscreen ? <Icons.Minimize size={20}/> : <Icons.Maximize size={20}/>}
                                    </button>
                                    <button onClick={() => setIsOverviewOpen(true)} className="p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 md:hidden">
                                        <Icons.List size={20}/>
                                    </button>
                                    <button 
                                        onClick={() => setIsSettingsOpen(true)}
                                        className="flex items-center gap-2 px-3 py-1.5 text-sm font-medium bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition-colors dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700"
                                    >
                                        <Icons.Settings size={16} /> 设置
                                    </button>
                                    <button 
                                        onClick={handleLogout}
                                        className="p-2 text-red-500 hover:bg-red-50 rounded-full dark:hover:bg-red-900/20"
                                        title="退出登录"
                                    >
                                        <Icons.LogOut size={20} />
                                    </button>
                                </div>
                            </div>
                        </header>

                        <main className="flex-1 max-w-6xl mx-auto w-full flex p-4 gap-6">
                            {/* Sidebar */}
                            <aside className="hidden md:block w-64 bg-white dark:bg-gray-800 rounded-xl shadow-sm overflow-hidden flex flex-col h-[calc(100vh-100px)] sticky top-24">
                                <div className="p-4 border-b dark:border-gray-700">
                                    <h3 className="font-bold text-gray-500 text-sm uppercase mb-2">题目列表</h3>
                                    {hasAnswerKey && (
                                        <div className="text-sm">
                                            正确率: <span className="font-bold text-green-600">{getScore().correct}</span> / {Object.keys(userAnswers).length}
                                        </div>
                                    )}
                                    <div className="text-xs text-gray-400 mt-1 flex flex-wrap gap-2">
                                        {isRandomMode ? "随机顺序" : "顺序排列"}
                                        {isFavoritesMode && " | 仅收藏"}
                                    </div>
                                </div>
                                
                                <div className="p-2 border-b dark:border-gray-700">
                                    <button 
                                        onClick={toggleFavoritesMode}
                                        className={`w-full py-2 px-3 rounded flex items-center justify-center gap-2 text-sm transition-colors ${isFavoritesMode ? 'bg-yellow-100 text-yellow-700 dark:bg-yellow-900 dark:text-yellow-300' : 'bg-gray-100 text-gray-600 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600'}`}
                                    >
                                        <Icons.Star size={16} filled={isFavoritesMode} />
                                        {isFavoritesMode ? "显示全部题目" : "只看收藏/错题"}
                                    </button>
                                </div>

                                <div className="flex-1 overflow-y-auto p-2 grid grid-cols-5 gap-1 content-start">
                                    {displayedQuestions.map((q, idx) => {
                                        const ans = userAnswers[q.id];
                                        const correct = answerKey[q.id];
                                        const isBm = bookmarks.includes(q.id);
                                        let bg = darkMode ? "bg-gray-700" : "bg-gray-100";
                                        let text = "text-gray-500";
                                        let border = "border-transparent";
                                        
                                        if (ans) {
                                            if (hasAnswerKey) {
                                                bg = (ans === correct) ? "bg-green-500" : "bg-red-500";
                                                text = "text-white";
                                            } else {
                                                bg = "bg-blue-500";
                                                text = "text-white";
                                            }
                                        }
                                        
                                        if (currentQIndex === idx) {
                                            border = "border-blue-500 ring-2 ring-blue-200 dark:ring-blue-900";
                                        }

                                        return (
                                            <button 
                                                key={q.id}
                                                onClick={() => setCurrentQIndex(idx)}
                                                className={`h-8 rounded text-xs font-medium transition-all relative border-2 ${bg} ${text} ${border}`}
                                            >
                                                {q.id}
                                                {isBm && <div className="absolute -top-1 -right-1 w-2 h-2 bg-yellow-400 rounded-full"></div>}
                                            </button>
                                        )
                                    })}
                                </div>
                                <div className="p-4 border-t dark:border-gray-700">
                                    <button onClick={resetProgress} className="w-full flex items-center justify-center gap-2 text-red-500 text-sm hover:bg-red-50 dark:hover:bg-red-900/30 p-2 rounded">
                                        <Icons.RefreshCw size={16} /> 重置进度
                                    </button>
                                </div>
                            </aside>

                            <section className="flex-1 max-w-3xl mx-auto w-full">
                                <div className="mb-4 bg-white dark:bg-gray-800 rounded-xl shadow-sm p-4 flex justify-between items-center text-sm font-medium">
                                    <div className="flex items-center gap-4">
                                        <div className="flex flex-col">
                                            <span className="text-xs text-gray-400 uppercase">当前题目</span>
                                            <span className="text-lg font-bold text-blue-600 dark:text-blue-400">{currentQIndex + 1} <span className="text-sm text-gray-400 font-normal">/ {displayedQuestions.length}</span></span>
                                        </div>
                                        <div className="h-8 w-px bg-gray-200 dark:bg-gray-700"></div>
                                        <div className="flex flex-col">
                                            <span className="text-xs text-gray-400 uppercase">已完成</span>
                                            <span>{stats.answered} 题</span>
                                        </div>
                                    </div>
                                    
                                    {hasAnswerKey && (
                                        <div className="flex items-center gap-2">
                                            <div className="flex flex-col items-end">
                                                <span className="text-xs text-gray-400 uppercase">实时正确率</span>
                                                <span className={`${stats.accuracy >= 60 ? 'text-green-600 dark:text-green-400' : 'text-red-500'} font-bold text-lg`}>
                                                    {stats.accuracy}%
                                                </span>
                                            </div>
                                            <div className="w-10 h-10 rounded-full flex items-center justify-center bg-gray-100 dark:bg-gray-700">
                                                <Icons.Zap size={18} className={stats.accuracy >= 60 ? 'text-green-500' : 'text-red-500'} fill="currentColor" />
                                            </div>
                                        </div>
                                    )}
                                </div>

                                <div className="bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6 min-h-[500px] flex flex-col">
                                    <div className="mb-6">
                                        <div className="flex justify-between items-start mb-2">
                                            <div className="flex gap-2 items-center">
                                                <span className="text-sm font-bold text-gray-400 uppercase tracking-wider">Question {currentQ.id}</span>
                                                {isRandomMode && <Icons.Shuffle size={14} className="text-purple-400" />}
                                            </div>
                                            <button 
                                                onClick={() => toggleBookmark(currentQ.id)}
                                                className={`p-2 rounded-full transition-colors ${isBookmarked ? 'bg-yellow-100 text-yellow-500 dark:bg-yellow-900/30' : 'text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700'}`}
                                                title="加入收藏/错题本"
                                            >
                                                <Icons.Star size={24} filled={isBookmarked} />
                                            </button>
                                        </div>
                                        <h2 className="text-xl md:text-2xl font-semibold mt-2 leading-relaxed">
                                            {currentQ.text}
                                        </h2>
                                    </div>

                                    <div className="flex-1">
                                        {currentQ.options.map((opt, i) => (
                                            <div 
                                                key={i} 
                                                onClick={() => handleOptionClick(opt)}
                                                className={getOptionClass(opt)}
                                            >
                                                <div className={`w-8 h-8 rounded-full flex items-center justify-center mr-4 border ${
                                                    currentUserAnswer === opt.charAt(0) 
                                                    ? 'border-transparent bg-blue-500 text-white' 
                                                    : 'border-gray-300 text-gray-500 dark:border-gray-600'
                                                }`}>
                                                    {opt.charAt(0)}
                                                </div>
                                                <span className="flex-1 text-lg">{opt.substring(2).trim()}</span>
                                                {hasAnswerKey && currentUserAnswer === opt.charAt(0) && (
                                                    currentUserAnswer === currentCorrectAnswer 
                                                    ? <Icons.CheckCircle className="text-green-500 ml-2" /> 
                                                    : <Icons.XCircle className="text-red-500 ml-2" />
                                                )}
                                            </div>
                                        ))}
                                    </div>

                                    <div className="mt-8 flex justify-between items-center pt-6 border-t dark:border-gray-700">
                                        <button 
                                            disabled={currentQIndex === 0}
                                            onClick={() => setCurrentQIndex(i => i - 1)}
                                            className="flex items-center gap-1 px-4 py-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-50"
                                        >
                                            <Icons.ChevronLeft size={20} /> 上一题
                                        </button>
                                        
                                        {!hasAnswerKey && (
                                            <span className="text-sm text-gray-400">
                                                未检测到答案
                                            </span>
                                        )}

                                        <button 
                                            disabled={currentQIndex === displayedQuestions.length - 1}
                                            onClick={() => setCurrentQIndex(i => i + 1)}
                                            className="flex items-center gap-1 px-4 py-2 rounded bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50"
                                        >
                                            下一题 <Icons.ChevronRight size={20} />
                                        </button>
                                    </div>
                                </div>
                            </section>
                        </main>

                        {isSettingsOpen && (
                            <div className="fixed inset-0 bg-black/50 z-[60] flex items-center justify-center p-4">
                                <div className="bg-white dark:bg-gray-800 rounded-xl shadow-xl max-w-lg w-full p-6">
                                    <h3 className="text-lg font-bold mb-4 flex items-center gap-2">
                                        <Icons.Settings size={20}/> 配置
                                    </h3>
                                    
                                    <div className="space-y-4 mb-6 pb-4 border-b dark:border-gray-700">
                                        <div className="flex justify-between items-center cursor-pointer" onClick={toggleRandomMode}>
                                            <div>
                                                <label className="block text-sm font-medium cursor-pointer">随机模式</label>
                                                <p className="text-xs text-gray-500">打乱题目顺序。切换会重置到第一题。</p>
                                            </div>
                                            <div className={`w-12 h-6 rounded-full p-1 transition-colors ${isRandomMode ? 'bg-purple-600' : 'bg-gray-300 dark:bg-gray-600'}`}>
                                                <div className={`bg-white w-4 h-4 rounded-full shadow-sm transform transition-transform ${isRandomMode ? 'translate-x-6' : ''}`}></div>
                                            </div>
                                        </div>

                                        <div className="flex justify-between items-center cursor-pointer" onClick={() => setAutoAdvance(!autoAdvance)}>
                                            <div>
                                                <label className="block text-sm font-medium cursor-pointer">自动跳转</label>
                                                <p className="text-xs text-gray-500">选对后自动进入下一题 (延迟0.5秒)</p>
                                            </div>
                                            <div className={`w-12 h-6 rounded-full p-1 transition-colors ${autoAdvance ? 'bg-blue-600' : 'bg-gray-300 dark:bg-gray-600'}`}>
                                                <div className={`bg-white w-4 h-4 rounded-full shadow-sm transform transition-transform ${autoAdvance ? 'translate-x-6' : ''}`}></div>
                                            </div>
                                        </div>
                                    </div>

                                    <div className="mb-4 pb-4 border-b dark:border-gray-700">
                                        <label className="block text-sm font-medium mb-2 text-red-500">危险区域</label>
                                        <button 
                                            onClick={hardReset}
                                            className="w-full py-2 px-4 border border-red-200 text-red-600 rounded bg-red-50 hover:bg-red-100 dark:bg-red-900/20 dark:border-red-800 dark:text-red-400 flex items-center justify-center gap-2"
                                        >
                                            <Icons.Trash2 size={16} /> 清空所有数据 (包括收藏)
                                        </button>
                                    </div>

                                    <div className="mb-4">
                                        <div className="flex justify-between items-center mb-2">
                                            <label className="block text-sm font-medium">答案配置</label>
                                            <button 
                                                onClick={resetToDefaultKey}
                                                className="text-xs text-blue-500 flex items-center gap-1 hover:underline"
                                            >
                                                <Icons.RefreshCw size={12}/> 恢复默认答案
                                            </button>
                                        </div>
                                        <textarea 
                                            value={rawAnswerKeyInput}
                                            onChange={(e) => setRawAnswerKeyInput(e.target.value)}
                                            className="w-full h-24 p-3 rounded border bg-gray-50 border-gray-300 dark:bg-gray-900 dark:border-gray-700 font-mono text-sm"
                                        />
                                    </div>

                                    <div className="flex justify-end gap-2">
                                        <button 
                                            onClick={() => setIsSettingsOpen(false)}
                                            className="px-4 py-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700"
                                        >
                                            关闭
                                        </button>
                                        <button 
                                            onClick={() => {
                                                parseAndSetKey(rawAnswerKeyInput);
                                                setIsSettingsOpen(false);
                                            }}
                                            className="px-4 py-2 rounded bg-blue-600 text-white hover:bg-blue-700 flex items-center gap-2"
                                        >
                                            <Icons.Save size={16} /> 保存
                                        </button>
                                    </div>
                                </div>
                            </div>
                        )}

                        {isOverviewOpen && (
                            <div className="fixed inset-0 bg-black/50 z-[60] flex justify-end">
                                <div className="bg-white dark:bg-gray-800 w-80 h-full p-4 overflow-y-auto">
                                    <div className="flex justify-between items-center mb-4">
                                        <h3 className="font-bold">题目列表</h3>
                                        <button onClick={() => setIsOverviewOpen(false)}><Icons.XCircle /></button>
                                    </div>
                                    <div className="mb-4">
                                        <button 
                                            onClick={() => {
                                                toggleFavoritesMode();
                                                setIsOverviewOpen(false);
                                            }}
                                            className={`w-full py-2 px-3 rounded flex items-center justify-center gap-2 text-sm border ${isFavoritesMode ? 'bg-yellow-100 text-yellow-700 border-yellow-300' : 'bg-gray-50 text-gray-600 border-gray-200'}`}
                                        >
                                            <Icons.Star size={16} filled={isFavoritesMode} />
                                            {isFavoritesMode ? "显示全部题目" : "只看收藏/错题"}
                                        </button>
                                    </div>
                                    <div className="grid grid-cols-5 gap-2">
                                        {displayedQuestions.map((q, idx) => {
                                            const ans = userAnswers[q.id];
                                            const correct = answerKey[q.id];
                                            const isBm = bookmarks.includes(q.id);
                                            let bg = darkMode ? "bg-gray-700" : "bg-gray-100";
                                            if (ans) {
                                                bg = hasAnswerKey ? (ans === correct ? "bg-green-500" : "bg-red-500") : "bg-blue-500";
                                            }
                                            return (
                                                <button 
                                                    key={q.id}
                                                    onClick={() => {
                                                        setCurrentQIndex(idx);
                                                        setIsOverviewOpen(false);
                                                    }}
                                                    className={`h-10 rounded text-xs font-medium relative ${bg} ${ans ? 'text-white' : 'text-gray-500'}`}
                                                >
                                                    {q.id}
                                                    {isBm && <div className="absolute -top-1 -right-1 w-2 h-2 bg-yellow-400 rounded-full"></div>}
                                                </button>
                                            )
                                        })}
                                    </div>
                                </div>
                            </div>
                        )}
                    </div>
                );
            }

            const root = ReactDOM.createRoot(document.getElementById('root'));
            root.render(<App />);
        } catch (error) {
            console.error("React Error:", error);
            document.getElementById('root').innerHTML = `<div style="padding:20px; color:red"><h3>应用程序加载失败</h3><p>错误详情: ${error.message}</p></div>`;
        }
    </script>
</body>
</html>